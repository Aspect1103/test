# Fetch the GoogleTest repository and initialise it
find_package(GTest CONFIG REQUIRED)

# Create an executable from our test code and link it against GTest and the C++ library
include(CTest)
add_executable(${TEST_MODULE}
        ${CMAKE_SOURCE_DIR}/tests/game_objects/test_registry.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/test_steering.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/systems/test_armour_regen.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/systems/test_attacks.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/systems/test_effects.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/systems/test_inventory.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/systems/test_movements.cpp
        ${CMAKE_SOURCE_DIR}/tests/game_objects/systems/test_upgrade.cpp
        ${CMAKE_SOURCE_DIR}/tests/generation/test_astar.cpp
        ${CMAKE_SOURCE_DIR}/tests/generation/test_bsp.cpp
        ${CMAKE_SOURCE_DIR}/tests/generation/test_map.cpp
        ${CMAKE_SOURCE_DIR}/tests/generation/test_primitives.cpp
)
target_include_directories(${TEST_MODULE} PUBLIC ${CMAKE_SOURCE_DIR}/tests)
target_link_libraries(
        ${TEST_MODULE}
        GTest::gtest
        GTest::gtest_main
        ${CPP_LIB}
)

# Add the executable as a test to CTest
add_test(NAME Tests COMMAND ${TEST_MODULE})
